# 主备租户容灾切换

当主租户不可用时，OCP 支持通过容灾切换将备租户切换为主租户。容灾切换完成后，原备租户成为可读写的独立主租户，与原主租户不再存在关联关系。

本页面为您介绍主备租户容灾切换的详细操作步骤。根据不同的业务需要，您可选择如下方式进行主备租户的容灾切换。

* 方式一：对指定主备租户进行容灾切换。
* 方式二：对集群下的所有主备租户进行容灾切换。

## 方式一：对指定主备租户进行容灾切换

该方式适用于将指定备租户切换为主租户的场景。

### 前提条件

* 当前租户为备租户，且备租户处于 **运行中**。

* 当前租户的所属主租户已不可用。

### 操作步骤

1. 登录 OceanBase 云平台，单击左侧导航栏 **租户** ，在 **租户列表** 中进入备租户。

2. 单击右上角更多图标，选择 **容灾切换** 。

3. 在弹出框中单击 **容灾切换** ，系统将进行租户预检查并提交任务。

   当预检查不通过，或任务提交失败时，可通过查看对话框中的失败原因进行排查。

   ![11221346](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/420/%E5%AE%B9%E7%81%BE-%E5%88%87%E4%B8%BA%E4%B8%BB%E7%A7%9F%E6%88%B7.png)

4. 任务提交成功后，单击对话框中的任务 ID，查看任务进度。

## 方式二：对集群下的所有主备租户进行容灾切换

该方式适用于将集群中所有的备租户 failover 成主租户的场景。

### 前提条件

当前集群下已创建备租户。

### 操作步骤

1. 登录 OceanBase 云平台，单击左侧导航栏 **集群** ，在 **集群列表** 中进入备租户所在集群的 **概览** 页面。

2. 单击右上角更多图标，选择 **租户容灾切换** 。

3. 在对话框中勾选需要切换的租户，单击 **容灾切换** 。

   在进行容灾切换前，系统会对主备租户是否满足如下条件进行检查。若检查不通过，则不支持勾选租户进行容灾切换：

      * 主备租户在不同集群下。
      * 备租户处于正常运行状态，且所属主租户已不可用。
      * 备租户所属集群为 **Running** 状态。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>容灾切换将断开租户的主备关系，将指定租户强制转为可读写租户，且不可恢复，请谨慎操作。</p>
    </main>

4. 单击对话框中的任务 ID，查看任务进度。
