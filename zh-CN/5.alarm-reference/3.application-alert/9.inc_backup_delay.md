inc_backup_delay 日志备份延迟
============================================

**告警描述**
-----------------------------

日志备份延迟时会触发该告警。

告警原理
-------------------------

OCP-Server 设置了每分钟的检查任务，当出现日志备份延迟超过阈值时触发告警。日志备份任务包括：

1. 逻辑日志备份

2. 物理日志备份

  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>阈值可通过在备份策略的 <strong>报警阈值配置</strong> 中配置 <strong>日志备份延时的报警阈值</strong> 参数。</p>
  </main>

**规则信息**
-----------------------------

| 监控指标 | 默认阈值 | 持续时间 | 检测周期 | 消除周期 |
|------|------|------|------|------|
| NA   | NA   | 0 秒  | 60 秒 | 5 分钟 |

**告警信息**
-----------------------------

|  告警触发方式  | 告警等级 | 范围 |
|----------|------|----|
| OCP 定时任务 | 严重   | 服务 |

**告警模板**
-----------------------------

* 告警概述模板：\${alarm_target} \${alarm_name}

* 告警详情模板：集群：\${ob_cluster_name}[\${ob_cluster_id}]，主机：\${host}，告警：日志备份延迟 \${log_backup_latency} 秒, 超过告警阈值：\${threshold} 秒，检查点：\${checkpoint}，当前时间：\${current_time}，租户列表：\${tenants}

* 告警概述样例：ob_cluster=obcluster-1 日志备份延迟

* 告警详情样例：集群：obcluster-1[10006]，主机：192.168.0.1，告警：日志备份延迟 30 秒，超过告警阈值：5 秒，检查点：2020-01-05 02:00:00，当前时间：2020-01-15 01:00:00，租户列表：tenant1,tenant2

**对系统的影响**
-------------------------------

日志备份延迟过大导致日志备份可能不是最新数据，恢复时有可能无法恢复到最近时刻，或者无法完成新的物理数据备份。

**可能原因**
-----------------------------

常见于以下原因：

* 日志备份任务异常。

* 备份介质有问题。

**处理方法**
-----------------------------

* 若为逻辑日志备份，请查看备份服务的 agentserver.log 日志排查具体原因。

* 若为物理日志备份，请查看 OBServer 日志排查具体原因。

  1. 在 OCP 的 **集群** 界面，通过 **集群列表** 进入到具体集群的 **总览** 页。

  2. 单击 **...** ，选择并单击 **下载日志** 。

     * 时间范围需包含告警时间。

     * 日志类型选择 **OBServer 日志** 。

  3. 单击 **下载** 。

     下载 OBServer 日志。

  4. 在下载的 observer.log 中搜索 WARN 和 ERROR 级别的日志。
