no_port_mapping_for_exporter 无 exporter 端口映射
=================================================================

**告警描述**
-----------------------------

HTTP 以拉取的方式获取监控数据，不同 exporter 会返回不同的数据，目前共 6 种类型的 exporter，其中 3 种用于 OBServer 的监控数据，2 种用于 OBProxy 的监控数据，1 种用于主机监控。V2.4.x 及之前版本每个 exporter 使用不同的监听端口，而 V2.5.x 及之后都使用同一个监听端口，exporter 启动如果发现无可用监听端口，会触发生成此告警项。

告警原理
-------------------------

OCP-Agent 作为主机监控的采集程序，在其启动时会检查必要的启动参数。若缺少端口映射，则触发该告警。

**规则信息**
-----------------------------

| 监控指标 | 默认阈值 | 监控指标来源 | 持续时间 | 检测周期 | 消除周期 |
|------|------|--------|------|------|------|
| NA   | NA   | NA     | 0 秒  | 60 秒 | 5 分钟 |

**告警信息**
-----------------------------

|     告警触发方式     | 告警等级 | 范围  |
|----------------|------|-----|
| Agent 向 OCP 推送 | 停服   | 服务器 |

**告警模板**
-----------------------------

* 告警概述模板: ${alarm_target} ${alarm_name}

* 告警详情模板: ${alarm_target} ${alarm_name}

* 告警概述样例: service=OCP:svr_ip=xxx.xxx.xxx.1 没有 exporter 的端口映射

* 告警详情样例: service=OCP:svr_ip=xxx.xxx.xxx.1 没有 exporter 的端口映射

**对系统的影响**
-------------------------------

OCP 云平台无法对故障主机的监控指标进行采集。部分指标还会用于告警检测，如果告警依赖的监控指标不可用，那么对应的告警功能也不可用。

**可能原因**
-----------------------------

端口已经被其它程序占用。

**处理方法**
-----------------------------

1. 到主机上使用 netstat 工具，检查 62881\~63881 范围的端口当前被哪个程序占用， 参考命令：

   ```shell
   netstat -anp| grep -E '(62|63)[0-9]{3}'
   ```

2. 停止步骤 1 发现的进程。

3. 登录到告警主机，参考 [OCP-Agent 运维脚本使用说明](../400.alarm-appendix/400.use-ocp-agent-scripts.md) 重启 OCP Agent 程序。
