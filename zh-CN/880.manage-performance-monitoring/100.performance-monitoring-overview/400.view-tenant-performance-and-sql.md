# 查看租户性能与 SQL

本页面为您介绍 OCP 对租户性能与 SQL 进行监控的功能，您可以通过以下两个入口进行查看：

* **入口一：**

   登录 OCP，进入租户概览页面，单击左侧导航栏的 **性能监控**。

* **入口二：**

   登录 OCP，在左侧导航栏单击 **性能监控**，进入 **OceanBase 租户** 页签下。

## 前提条件

当前登录 OCP 的用户具有待查看租户的 **只读** 权限。

## 操作步骤

以下步骤以 **入口二** 为例。

1. 登录 OCP 。

2. 在左侧导航栏选择 **性能监控** 。

3. 选择 **OceanBase 租户** 页签。

4. 在 **数据筛选** 区域，配置监控数据筛选条件。

   筛选条件说明如下表所示：

   |     筛选条件  |  描述  |
   |---------------|---------|
   | 集群 | 自动刷新模式下不展示。选择某一个集群，对该集群进行监控。  |
   |Zone |默认对所有 Zone 进行监控。|
   |OBServer|默认对所有 OBServer 节点进行监控。|
   | 选择时间（又称：监控窗口） | 自动刷新模式下不展示。 选择某一段时间范围，用于返回这段时间范围内的数据。  |
   |自动刷新  |默认关闭，打开后，每 5s 进行一次刷新。|
  
   ![Image 113](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E7%A7%9F%E6%88%B7-%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89.png)
  
5. 系统默认进入 **主机性能** 页签下，在该页签中查看租户性能与 SQL 监控数据。

   此处所有监控项的具体含义及取值来源，您都可参考 [监控指标概述](../../1900.reference-guide/300.monitoring-indicator-reference/100.overview-of-metrics.md) 理解。如统计范围内涉及多台 OBServer 节点时，则展示聚合值。

     <main id="notice" type='notice'>
      <h4>说明</h4>
      <p><b>SQL 执行时间</b> 监控指标适用于 OceanBase V3.2.4.1 及以上版本（不包括 OceanBase V4.0.0.0 版本）。</p>
      </main>

   下述功能能够帮您更好地在趋势图中查看和分析详细性能监控数据，您可结合图片及下述文字理解。

   ![Image 114](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E7%A7%9F%E6%88%B7-sql%E6%80%A7%E8%83%BD.png)

   * 筛选数据。

     1. 查看某一指标的在某一时间段的详细趋势：可鼠标拖拽选中该区域，系统会放大显示该区域的趋势信息，双击该趋势图可恢复，如上图示 ①。

     2. 隐藏其他细分指标的数据：单击其他细分指标标识，使其置灰，趋势图中将不展示该指标信息，如上图示 ②。

     3. 查看某时刻详细数据：鼠标悬停于趋势图中某时刻，如上图示 ③。

   * 放大某一趋势图：单击趋势图右上角的放大图标。上图 ①、②、③ 的功能在放大的趋势图中同样适用。

   * 查看 SQL 请求分析：在 **响应时间** 趋势图中，单击趋势图右上角的 **SQL 请求分析** 图标，可查看请求分析详情，详见 [查看请求分析](../../1000.diagnosis-and-tuning-fuctions/100.manage-sql-diagnosis/1300.view-request-analysis.md) 。

        <main id="notice" type='explain'>
        <h4>说明</h4>
        <p>仅 <strong>响应时间</strong> 支持查看 SQL 请求分析。</p>
        </main>

   * 下钻查看不同维度的监控数据：当您发现租户的监控数据异常时，如租户响应时间过高，您可通过下钻分析，定位到引起响应时间异常的服务器。单击趋势图右上角的 **下钻分析** 图标，即可查看下钻分析详情。**性能与 SQL** 支持的下钻的维度为：**租户 \> OBServer**。

       上图 ①、②、③ 的功能在下钻页面的趋势图中同样适用，此外您还可以：

       ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/410/%E7%A7%9F%E6%88%B7-%E4%B8%8B%E9%92%BB.png)

       * 在图示 ① 的 **数据筛选** 区域重新设置筛选条件，如您未设置则会自动继承上层设置。

       * 如该指标存在细分指标，您可以选择细分指标进行查看或对该细分指标继续下钻，如图示 ②。

       * 趋势图中为您提供了 **查找请求次数最多的 SQL** 功能，单击 **查找请求次数最多的 SQL** 链接，如图示 ③，您可查看租户的 TopSQL 诊断详情。

       * 提供 **前往主机性能监控** 功能，将光标悬停于 **前往主机性能监控** 的链接上，选择您想查看的主机，即可跳转到相关主机的 **性能监控** 页面查看主机监控详情，如图示 ④。

       * 您也可通过趋势图右侧如图示 ⑤ 的按钮，选择需要在趋势图中展示的主机。

       ![集群监控下钻_new](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/ocp/421/%E5%9B%BE%E7%89%87.gif)
